# 📌 Video Scene Search System

## 프로젝트 개요
### 🎯 주제
TVING 해커톤에서 영상 검색 시스템을 구축하는 과제를 수행하였습니다. 사용자가 원하는 장면을 쉽게 탐색할 수 있도록 Video-to-Text 및 Text-to-Frame 모델을 개발하였으며, 검색 성능을 최적화하기 위해 CLIP, BLIP2, Scene Description 임베딩을 활용한 RankFusion 검색시스템을 구현했습니다.

### 📌 주요 기능
- **Video-to-Text (VTT):** 동영상 데이터를 프레임 단위와 장면(Scene) 단위로 분석하여 텍스트 캡션을 생성
- **Text-to-Frame (TTF):** 입력된 텍스트 쿼리에 대해 가장 적합한 장면을 검색하여 프레임 또는 영상 구간을 반환
- **여러 임베딩 활용:** CLIP, BLIP2, Scene Description 3개의 임베딩을 활용하여 검색 성능 극대화
- **검색 최적화:** Rank Fusion 및 Reranking 기법 적용하여 검색 정확도를 84.9%까지 향상
- **Streamlit 기반 인터페이스:** 사용자 친화적인 영상 검색 UI 개발

## 🛠 프로젝트 수행 절차 및 방법

### 📂 1. 데이터 전처리
- **프레임 단위 처리:**
  - FPS 10으로 샘플링하여 이미지 프레임 생성
  - BLIP2 및 CLIP 모델을 활용하여 프레임 임베딩 생성
- **장면(Scene) 단위 처리:**
  - PySceneDetect를 활용하여 장면 분할
  - Whisper 모델을 이용한 오디오 스크립트 추출
  - LLaVA-Video 모델을 활용한 Scene Caption 생성

### 📊 2. 검색 시스템 구축
- **계층적 Retrieval 시스템 설계**
  - Frame Embedding: BLIP2, CLIP 활용
  - Scene Embedding: Video Caption(BGE) 적용
  - Rank Fusion을 활용한 다중 임베딩 조합 및 가중치 최적화
- **Retrieval 성능 최적화**
  - FPS 조정 및 클러스터링을 활용한 중복 프레임 제거
  - 검색된 결과의 Reranking을 통해 최적의 장면을 상위에 배치

### 🔍 3. 검색 성능 평가 및 개선
- **벤치마크 구축:**
  - 22개 영상에서 132개의 쿼리와 정답 구간 구축
  - 단순 장면 묘사, 행동 반영 쿼리, 단어 단위 쿼리 등 3가지 유형으로 나누어 성능 측정
- **정성적 평가:**
  - Streamlit 기반 평가도구 개발 및 활용
  - Scene Caption 성능 검증 및 최적 모델 선정 (LLaVA-Video)

### 🎥 4. Demo 및 최적화
- **Streamlit UI 개발**
  - 영상 검색 시스템을 위한 웹 인터페이스 구현
  - 입력된 쿼리에 대해 Top5 장면을 검색하고, 최적의 장면을 제공
- **Reranking 기법 적용**
  - 핵심 키워드 추출 및 희귀도 기반 검색 가중치 조정
  - VLM을 활용하여 검색된 후보 이미지 재평가

## 👥 팀 구성 및 역할
| 이름 | 역할 |
|-------|-------|
| **육지훈** | 비디오 데이터 전처리 & 장면 탐지 분할, 프레임 추출 및 이미지 임베딩 생성, Streamlit 기반 장면 검색 시스템 개발, Reranking 기반 검색 성능 개선 |
| **전진** | 테스트 데이터셋 및 벤치마크 구축, 계층적 리트리버 구조 설계, Rank Fusion Retrieval |
| **허윤서** | VTT & TTV app.py 제작, 멀티모달 임베딩, Rank Fusion Retrieval 구축 |
| **정준한** | VLM & VideoLM 추론 코드 모듈화, Streamlit 기반 평가도구 & 데모 구현 |
| **이수진** | Video Captioning 모델 실험, VideoLM 모듈화, 테스트 데이터셋 및 벤치마크 구축 |
| **이금상** | Video Captioning 모델 실험, VideoLM 모듈화, Audio 임베딩 모델 개발 |

## 📈 프로젝트 성과
- 검색 성능 **13.6% → 84.9%** 대폭 향상
- Rank Fusion 및 Reranking 기법을 적용하여 Top-1 검색 정확도 **71.2% → 84.9%** 개선
- FPS 10 기준 샘플링 및 클러스터링 기법 적용으로 중복 프레임 제거 및 검색 최적화
- 오디오 및 행동 정보를 활용한 Scene Caption 기법 도입
- Streamlit 기반 인터페이스 개발로 실제 서비스 가능 수준의 시스템 구축

## 🚀 향후 개선 방향
1. **오디오 정보 활용 강화:**
   - 현재 Whisper 및 CLAP을 적용했으나 검색 성능 향상이 제한적이었음
   - 향후 오디오-텍스트 융합 멀티모달 기법 연구 필요
2. **평가 방식 개선:**
   - 벤치마크 데이터셋이 제한적이므로 일반화 성능 검증 부족
   - 다양한 영상 데이터 추가 및 대규모 벤치마크 구축 필요

---

이 프로젝트는 TVING 해커톤에서 영상 검색 성능을 극대화하는 방향으로 진행되었으며, 앞으로도 지속적인 개선을 통해 더 정교한 검색 시스템으로 발전시켜 나갈 계획입니다.
감사합니다!

